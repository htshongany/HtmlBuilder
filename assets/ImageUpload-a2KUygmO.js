import{r as s,j as t}from"./react-DPbnXjGw.js";import c from"./Icon-BSY9YNvu.js";import{A as x,M as v,a as y}from"./index-D1nS-IVF.js";import"./highlight.js-vNZFY2Ar.js";import"./react-dom-D6bd396G.js";import"./scheduler-SPyfQU6S.js";import"./@google-BABIsQe9.js";import"./zod-Afug2wbS.js";const L=({onImageSelect:n,imagePreviewUrl:g,hideLabel:C,mode:r="upload"})=>{const[p,u]=s.useState(null),[h,f]=s.useState(!1),m=s.useRef(null),d=s.useRef(null),o=s.useCallback(e=>{if(u(null),e){if(!x.includes(e.type)){u(`Type de fichier invalide. Veuillez utiliser : ${x.join(", ")}.`),n(null,null);return}if(e.size>v){u(`Fichier trop volumineux. La taille maximale est de ${y}MB.`),n(null,null);return}const a=new FileReader;a.onloadend=()=>{n(e,a.result)},a.onerror=()=>{u("Échec de la lecture du fichier."),n(null,null)},a.readAsDataURL(e)}else n(null,null)},[n]),N=e=>{o(e.target.files?e.target.files[0]:null)},E=e=>{var l;if(r==="paste"){e.preventDefault();return}const a=e.target;a.closest("button")||a.closest(".group")||(l=d.current)==null||l.click()},D=s.useCallback(e=>{e.preventDefault(),e.stopPropagation(),f(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0&&(o(e.dataTransfer.files[0]),e.dataTransfer.clearData())},[o]),P=s.useCallback(e=>{e.preventDefault(),e.stopPropagation(),f(!0)},[]),k=s.useCallback(e=>{e.preventDefault(),e.stopPropagation();const a=e.currentTarget.getBoundingClientRect(),l=e.clientX,i=e.clientY;(l<a.left||l>a.right||i<a.top||i>a.bottom)&&f(!1)},[]),z=e=>{e.stopPropagation(),n(null,null),d.current&&(d.current.value="")};return s.useEffect(()=>{const e=a=>{if(a.clipboardData){const l=a.clipboardData.items;for(let i=0;i<l.length;i++){const b=l[i];if(b.type.startsWith("image/")){const j=b.getAsFile();if(j){o(j),a.preventDefault();break}}}}};return document.addEventListener("paste",e),()=>{document.removeEventListener("paste",e)}},[o]),s.useEffect(()=>{r==="paste"&&m.current&&m.current.focus()},[r]),t.jsxs("div",{className:"mb-6",children:[!C&&t.jsx("label",{htmlFor:"image-upload-input",className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Design Image"}),t.jsxs("div",{ref:m,tabIndex:0,className:`relative flex flex-col items-center justify-center w-full h-48 border-2 border-dashed rounded-xl transition-colors
          ${r==="upload"?"cursor-pointer":"cursor-default"}
          ${h?"border-primary bg-indigo-50":"border-gray-300 bg-gray-50"}
          ${r==="upload"&&!h?"hover:bg-gray-100":""}
          ${p?"border-red-500":""}`,onClick:E,onDrop:D,onDragOver:P,onDragLeave:k,"aria-label":r==="paste"?"Paste or drag image here":"Click to upload, drag or paste image",role:"button",children:[t.jsxs("div",{className:"absolute top-2 left-2 z-20 group",children:[t.jsx(c,{name:"fas fa-info-circle",className:"text-lg text-gray-400 cursor-help"}),t.jsx("div",{className:"hidden group-hover:block absolute left-6 top-0 bg-white border border-gray-300 rounded shadow-md px-3 py-2 text-xs text-gray-700 w-56 z-30",children:r==="paste"?"Collez (Ctrl+V) ou glissez-déposez une image.":"Cliquez pour sélectionner une image, glissez-déposez ou collez (Ctrl+V) une image."})]}),t.jsx("input",{ref:d,id:"image-upload-input",type:"file",className:"hidden",accept:x.join(","),onChange:N}),g?t.jsxs("div",{className:"relative flex flex-col items-center justify-center text-center p-2 h-full w-full",children:[t.jsx("img",{src:g,alt:"Preview",className:"max-h-40 w-full object-contain rounded mb-2",loading:"lazy"}),t.jsx("button",{onClick:z,className:"absolute top-2 right-2 text-red-500 hover:text-red-700 text-xl z-10 bg-white rounded-full p-1 shadow-md","aria-label":"Remove image",type:"button",children:t.jsx(c,{name:"fas fa-trash"})})]}):t.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6 text-center",children:[t.jsx(c,{name:"fas fa-cloud-upload-alt",className:"text-4xl text-gray-400 mb-3"}),t.jsx("p",{className:"mb-2 text-sm text-gray-500 flex items-center justify-center gap-1",children:r==="paste"?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"font-semibold",children:"Paste"})," or drag & drop",t.jsx("span",{title:"Paste an image (Ctrl+V)",children:t.jsx(c,{name:"fas fa-clipboard",className:"text-base text-gray-400 ml-1"})})]}):t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag & drop or",t.jsxs("span",{className:"underline flex items-center gap-1",children:["paste",t.jsx("span",{title:"Paste an image (Ctrl+V)",children:t.jsx(c,{name:"fas fa-clipboard",className:"text-base text-gray-400 ml-1"})})]})]})}),t.jsxs("p",{className:"text-xs text-gray-500",children:["PNG, JPG, GIF, WEBP (MAX. ",y,"MB)"]})]})]}),p&&t.jsx("p",{className:"mt-2 text-sm text-red-600",children:p})]})};export{L as default};
