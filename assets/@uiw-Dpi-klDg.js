import{_ as X,a as _}from"./@babel-Cv5OCJ0e.js";import{r as l,j as Z}from"./react-DPbnXjGw.js";import{c as $,d as ee,s as te,h as ae,f as re,a as ie,l as se,b as ne,e as oe,g as le,i as ce,j as ue,k as fe,m as he,E as z,n as de,o as J,p as ge,q as me,r as pe,t as be,u as ve,v as ye,w as Se,x as ke,y as xe,z as Y,A as v,B as Ce,C as Ee,D as Ne,F as Le,S as Me,H as Te}from"./@codemirror-BrsHXVAL.js";import{a as e}from"./@lezer-kGRDH3v9.js";var q=function(t){t===void 0&&(t={});var{crosshairCursor:a=!1}=t,i=[];t.closeBracketsKeymap!==!1&&(i=i.concat($)),t.defaultKeymap!==!1&&(i=i.concat(ee)),t.searchKeymap!==!1&&(i=i.concat(te)),t.historyKeymap!==!1&&(i=i.concat(ae)),t.foldKeymap!==!1&&(i=i.concat(re)),t.completionKeymap!==!1&&(i=i.concat(ie)),t.lintKeymap!==!1&&(i=i.concat(se));var r=[];return t.lineNumbers!==!1&&r.push(ne()),t.highlightActiveLineGutter!==!1&&r.push(oe()),t.highlightSpecialChars!==!1&&r.push(le()),t.history!==!1&&r.push(ce()),t.foldGutter!==!1&&r.push(ue()),t.drawSelection!==!1&&r.push(fe()),t.dropCursor!==!1&&r.push(he()),t.allowMultipleSelections!==!1&&r.push(z.allowMultipleSelections.of(!0)),t.indentOnInput!==!1&&r.push(de()),t.syntaxHighlighting!==!1&&r.push(J(ge,{fallback:!0})),t.bracketMatching!==!1&&r.push(me()),t.closeBrackets!==!1&&r.push(pe()),t.autocompletion!==!1&&r.push(be()),t.rectangularSelection!==!1&&r.push(ve()),a!==!1&&r.push(ye()),t.highlightActiveLine!==!1&&r.push(Se()),t.highlightSelectionMatches!==!1&&r.push(ke()),t.tabSize&&typeof t.tabSize=="number"&&r.push(xe.of(" ".repeat(t.tabSize))),r.concat([Y.of(i.flat())]).filter(Boolean)},Be=v.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),De=function(t){t===void 0&&(t={});var{indentWithTab:a=!0,editable:i=!0,readOnly:r=!1,theme:c="light",placeholder:u="",basicSetup:h=!0}=t,o=[];switch(a&&o.unshift(Y.of([Ce])),h&&(typeof h=="boolean"?o.unshift(q()):o.unshift(q(h))),u&&o.unshift(Ee(u)),c){case"light":o.push(Be);break;case"dark":o.push(Ne);break;case"none":break;default:o.push(c);break}return i===!1&&o.push(v.editable.of(!1)),r&&o.push(z.readOnly.of(!0)),[...o]},Fe=s=>({line:s.state.doc.lineAt(s.state.selection.main.from),lineCount:s.state.doc.lines,lineBreak:s.state.lineBreak,length:s.state.doc.length,readOnly:s.state.readOnly,tabSize:s.state.tabSize,selection:s.state.selection,selectionAsSingle:s.state.selection.asSingle().main,ranges:s.state.selection.ranges,selectionCode:s.state.sliceDoc(s.state.selection.main.from,s.state.selection.main.to),selections:s.state.selection.ranges.map(t=>s.state.sliceDoc(t.from,t.to)),selectedText:s.state.selection.ranges.some(t=>!t.empty)});class We{constructor(t,a){this.timeLeftMS=void 0,this.timeoutMS=void 0,this.isCancelled=!1,this.isTimeExhausted=!1,this.callbacks=[],this.timeLeftMS=a,this.timeoutMS=a,this.callbacks.push(t)}tick(){if(!this.isCancelled&&!this.isTimeExhausted&&(this.timeLeftMS--,this.timeLeftMS<=0)){this.isTimeExhausted=!0;var t=this.callbacks.slice();this.callbacks.length=0,t.forEach(a=>{try{a()}catch(i){console.error("TimeoutLatch callback error:",i)}})}}cancel(){this.isCancelled=!0,this.callbacks.length=0}reset(){this.timeLeftMS=this.timeoutMS,this.isCancelled=!1,this.isTimeExhausted=!1}get isDone(){return this.isCancelled||this.isTimeExhausted}}class V{constructor(){this.interval=null,this.latches=new Set}add(t){this.latches.add(t),this.start()}remove(t){this.latches.delete(t),this.latches.size===0&&this.stop()}start(){this.interval===null&&(this.interval=setInterval(()=>{this.latches.forEach(t=>{t.tick(),t.isDone&&this.remove(t)})},1))}stop(){this.interval!==null&&(clearInterval(this.interval),this.interval=null)}}var U=null,He=()=>typeof window>"u"?new V:(U||(U=new V),U),P=Le.define(),Oe=200,Ie=[];function Ke(s){var{value:t,selection:a,onChange:i,onStatistics:r,onCreateEditor:c,onUpdate:u,extensions:h=Ie,autoFocus:o,theme:y="light",height:L=null,minHeight:S=null,maxHeight:M=null,width:T=null,minWidth:B=null,maxWidth:D=null,placeholder:F="",editable:W=!0,readOnly:H=!1,indentWithTab:O=!0,basicSetup:I=!0,root:A,initialState:E}=s,[k,K]=l.useState(),[n,g]=l.useState(),[x,C]=l.useState(),f=l.useState(()=>({current:null}))[0],m=l.useState(()=>({current:null}))[0],G=v.theme({"&":{height:L,minHeight:S,maxHeight:M,width:T,minWidth:B,maxWidth:D},"& .cm-scroller":{height:"100% !important"}}),R=v.updateListener.of(d=>{if(d.docChanged&&typeof i=="function"&&!d.transactions.some(j=>j.annotation(P))){f.current?f.current.reset():(f.current=new We(()=>{if(m.current){var j=m.current;m.current=null,j()}f.current=null},Oe),He().add(f.current));var p=d.state.doc,b=p.toString();i(b,d)}r&&r(Fe(d))}),w=De({theme:y,editable:W,readOnly:H,placeholder:F,indentWithTab:O,basicSetup:I}),N=[R,G,...w];return u&&typeof u=="function"&&N.push(v.updateListener.of(u)),N=N.concat(h),l.useLayoutEffect(()=>{if(k&&!x){var d={doc:t,selection:a,extensions:N},p=E?z.fromJSON(E.json,d,E.fields):z.create(d);if(C(p),!n){var b=new v({state:p,parent:k,root:A});g(b),c&&c(b,p)}}return()=>{n&&(C(void 0),g(void 0))}},[k,x]),l.useEffect(()=>{s.container&&K(s.container)},[s.container]),l.useEffect(()=>()=>{n&&(n.destroy(),g(void 0)),f.current&&(f.current.cancel(),f.current=null)},[n]),l.useEffect(()=>{o&&n&&n.focus()},[o,n]),l.useEffect(()=>{n&&n.dispatch({effects:Me.reconfigure.of(N)})},[y,h,L,S,M,T,B,D,F,W,H,O,I,i,u]),l.useEffect(()=>{if(t!==void 0){var d=n?n.state.doc.toString():"";if(n&&t!==d){var p=f.current&&!f.current.isDone,b=()=>{n&&t!==n.state.doc.toString()&&n.dispatch({changes:{from:0,to:n.state.doc.toString().length,insert:t||""},annotations:[P.of(!0)]})};p?m.current=b:b()}}},[t,n]),{state:x,setState:C,view:n,setView:g,container:k,setContainer:K}}var we=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],ze=l.forwardRef((s,t)=>{var{className:a,value:i="",selection:r,extensions:c=[],onChange:u,onStatistics:h,onCreateEditor:o,onUpdate:y,autoFocus:L,theme:S="light",height:M,minHeight:T,maxHeight:B,width:D,minWidth:F,maxWidth:W,basicSetup:H,placeholder:O,indentWithTab:I,editable:A,readOnly:E,root:k,initialState:K}=s,n=X(s,we),g=l.useRef(null),{state:x,view:C,container:f,setContainer:m}=Ke({root:k,value:i,autoFocus:L,theme:S,height:M,minHeight:T,maxHeight:B,width:D,minWidth:F,maxWidth:W,basicSetup:H,placeholder:O,indentWithTab:I,editable:A,readOnly:E,selection:r,onChange:u,onStatistics:h,onCreateEditor:o,onUpdate:y,extensions:c,initialState:K});l.useImperativeHandle(t,()=>({editor:g.current,state:x,view:C}),[g,f,x,C]);var G=l.useCallback(w=>{g.current=w,m(w)},[m]);if(typeof i!="string")throw new Error("value must be typeof string but got "+typeof i);var R=typeof S=="string"?"cm-theme-"+S:"cm-theme";return Z.jsx("div",_({ref:G,className:""+R+(a?" "+a:"")},n))});ze.displayName="CodeMirror";var Q=s=>{var{theme:t,settings:a={},styles:i=[]}=s,r={".cm-gutters":{}},c={};a.background&&(c.backgroundColor=a.background),a.backgroundImage&&(c.backgroundImage=a.backgroundImage),a.foreground&&(c.color=a.foreground),a.fontSize&&(c.fontSize=a.fontSize),(a.background||a.foreground)&&(r["&"]=c),a.fontFamily&&(r["&.cm-editor .cm-scroller"]={fontFamily:a.fontFamily}),a.gutterBackground&&(r[".cm-gutters"].backgroundColor=a.gutterBackground),a.gutterForeground&&(r[".cm-gutters"].color=a.gutterForeground),a.gutterBorder&&(r[".cm-gutters"].borderRightColor=a.gutterBorder),a.caret&&(r[".cm-content"]={caretColor:a.caret},r[".cm-cursor, .cm-dropCursor"]={borderLeftColor:a.caret});var u={};a.gutterActiveForeground&&(u.color=a.gutterActiveForeground),a.lineHighlight&&(r[".cm-activeLine"]={backgroundColor:a.lineHighlight},u.backgroundColor=a.lineHighlight),r[".cm-activeLineGutter"]=u,a.selection&&(r["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:a.selection+" !important"}),a.selectionMatch&&(r["& .cm-selectionMatch"]={backgroundColor:a.selectionMatch});var h=v.theme(r,{dark:t==="dark"}),o=Te.define(i),y=[h,J(o)];return y},Ae={background:"#fff",foreground:"#24292e",selection:"#BBDFFF",selectionMatch:"#BBDFFF",gutterBackground:"#fff",gutterForeground:"#6e7781"},Ge=[{tag:[e.standard(e.tagName),e.tagName],color:"#116329"},{tag:[e.comment,e.bracket],color:"#6a737d"},{tag:[e.className,e.propertyName],color:"#6f42c1"},{tag:[e.variableName,e.attributeName,e.number,e.operator],color:"#005cc5"},{tag:[e.keyword,e.typeName,e.typeOperator,e.typeName],color:"#d73a49"},{tag:[e.string,e.meta,e.regexp],color:"#032f62"},{tag:[e.name,e.quote],color:"#22863a"},{tag:[e.heading,e.strong],color:"#24292e",fontWeight:"bold"},{tag:[e.emphasis],color:"#24292e",fontStyle:"italic"},{tag:[e.deleted],color:"#b31d28",backgroundColor:"ffeef0"},{tag:[e.atom,e.bool,e.special(e.variableName)],color:"#e36209"},{tag:[e.url,e.escape,e.regexp,e.link],color:"#032f62"},{tag:e.link,textDecoration:"underline"},{tag:e.strikethrough,textDecoration:"line-through"},{tag:e.invalid,color:"#cb2431"}],Re=s=>{var{theme:t="light",settings:a={},styles:i=[]}={};return Q({theme:t,settings:_({},Ae,a),styles:[...Ge,...i]})};Re();var je={background:"#0d1117",foreground:"#c9d1d9",caret:"#c9d1d9",selection:"#003d73",selectionMatch:"#003d73",lineHighlight:"#36334280"},Ue=[{tag:[e.standard(e.tagName),e.tagName],color:"#7ee787"},{tag:[e.comment,e.bracket],color:"#8b949e"},{tag:[e.className,e.propertyName],color:"#d2a8ff"},{tag:[e.variableName,e.attributeName,e.number,e.operator],color:"#79c0ff"},{tag:[e.keyword,e.typeName,e.typeOperator,e.typeName],color:"#ff7b72"},{tag:[e.string,e.meta,e.regexp],color:"#a5d6ff"},{tag:[e.name,e.quote],color:"#7ee787"},{tag:[e.heading,e.strong],color:"#d2a8ff",fontWeight:"bold"},{tag:[e.emphasis],color:"#d2a8ff",fontStyle:"italic"},{tag:[e.deleted],color:"#ffdcd7",backgroundColor:"ffeef0"},{tag:[e.atom,e.bool,e.special(e.variableName)],color:"#ffab70"},{tag:e.link,textDecoration:"underline"},{tag:e.strikethrough,textDecoration:"line-through"},{tag:e.invalid,color:"#f97583"}],_e=s=>{var{theme:t="dark",settings:a={},styles:i=[]}={};return Q({theme:t,settings:_({},je,a),styles:[...Ue,...i]})},Ye=_e();export{ze as R,Ye as g};
